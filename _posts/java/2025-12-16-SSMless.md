---
layout:     post
title:      "less SSM "
subtitle:   " \"成为J佬的一天\""
date:       2025-12-13 12:00:00
author:     "HZY"
header-img: "img/java/1.png"
catalog: true
tags:
    - Java
---

 ### Spring基于注解+配置类开发
##### @Bean
* bean的id的作用，也就是在
* `@Scope`标注作用域
* `@PreDestory`
* `@PostConstruct`
* `@Bean(initMethod = "init", destroyMethod = "destroy")`
     * >这里详细说一下这个@Bean，假设我们想要引入外部的类，那么我们要么找到这个类，在它头上标注@Component，要么我们就用@Bean在配置类中把它加入组件。
     * >对于这个initMethod,destoryMethod,它俩和@PreDestory@PostConstruct本质上没什么区别，实际上就是用法的区别，前者是后期@Bean指定，而后者则是侵入性的;前者是Spring框架的，后者是JSR标准，泛用性不同
##### @Component
创建组件的方法
* `@Service`
* `@Controller`
* `@Reposity`

* `@PreDestory`
* `@PostConstruc`
>这些注解就是完成不同类型的组件的创建，声明要把哪些组件放入容器
##### @Bean 与  @Component
>其实有很多人搞不清楚这两个的概念，实际上二者都作为组件，本身来说没有什么差别，都有各种各样的方法等等。。。

| 场景        | 推荐                                 |
| --------- | ---------------------------------- |
| 自己写的 Bean | `@PostConstruct / @PreDestroy`     |
| 第三方类      | `@Bean(initMethod, destroyMethod)` |
| 线程池 / MQ  | `@PreDestroy`                      |
| 数据源       | 通常不需要                              |

##### @Import
>在很多情况，我们不方便用，也不适合用@Component和@Bean,比如我们要从外部的包里面导入一个组件，但我们肯定不想侵入这个类，这时候我们就2使用Import导入

| 注解           | 核心角色     | 解决什么问题                |
| ------------ | -------- | --------------------- |
| `@Component` | **声明组件** | “这是一个 Spring 管理的业务组件” |
| `@Bean`      | **定义对象** | “这个对象由我来创建和配置”        |
| `@Import`    | **引入配置** | “把别人定义的一整套 Bean 引进来”  |

##### @Configuration
方便我们统一进行@Bean,方便对同类型Bean的管理，也可以进行一些其他的配置操作
* `@ComponentScan("{}")`
* `PropertyScan("")`


``` java
@Configuration
@ComponentScan(basePackages = "com.atguigu")
@PropertySource("classpath:jdbc.properties")
public class JavaConfig {

    @Value("${atguigu.url}")
    private String url;
    @Value("${atguigu.driver}")
    private String driver;
    @Value("${atguigu.username}")
    private String username;
    @Value("${atguigu.password}")
    private String password;

    @Bean(destroyMethod = "close")
    public DruidDataSource dataSource(){
        DruidDataSource dataSource = new DruidDataSource();
        dataSource.setUrl(url);
        dataSource.setDriverClassName(driver);
        dataSource.setUsername(username);
        dataSource.setPassword(password);
        return dataSource;
    }

    @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)
    @Bean
    public JdbcTemplate jdbcTemplate(DataSource dataSource){
        JdbcTemplate jdbcTemplate = new JdbcTemplate();
        jdbcTemplate.setDataSource(dataSource);
        return jdbcTemplate;
    }

}
```
##### @Scope
>首先需要明白，bean或者component都是组件，所以@Scope不存在只能谁用的概念

| Scope           | 含义               | 常见场景          |
| --------------- | ---------------- | ------------- |
| `singleton`（默认） | 容器唯一             | Service / DAO |
| `prototype`     | 每次新建             | 临时上下文         |
| `request`       | 每次 HTTP 请求       | Web 请求数据      |
| `session`       | 每个 Session       | 登录态           |
| `application`   | ServletContext 级 | 全局共享          |
| 自定义             | 自己实现             | 高级场景          |

>什么时候要使用prototype呢？遇到并发的时候，一个TaskContext可能同时被两个线程调用，这样可能导致数据混乱，所以要使用prototype

Spring 不做的事情
* ❌ 不跟踪这个 Bean
* ❌ 不管理生命周期结束
* ❌ 不调用`@PreDestroy`
* ❌ 不调用`destroyMethod`

Sping做的事情
1. new 实例
2. 依赖注入
3. 调用 @PostConstruct
4. 调用 initMethod（如果有）
5. 把对象交给你
 
##### @Conditional

>决定是否要加入为Bean的注解，常在加入Bean时进行Conditional判断

##### @Autowired

>自动注入，自动注入的时候会遇到需要指定的情况，比如不知道要注入给哪个实例。
这时候可以使用`@Qualifier`和`@Primary`进行指定

* 普通方法注入方式(Spring推荐)
* setter方法注入

##### @Value

>上面刚才说了很多关于Bean注入的方法，但是对于一些值，比如我们要给实例的属性注入值,这时候就需要用到`@Value`注解了。

注意事项：
* 要先加入资源`@PropertySource`
* 允许`@Value`("#{表达式}")
* 允许`@Value`("#{方法/...}")
##### 数据源配置
>之前我们使用的是`@Profile`方法配置，其实我们可以直接使用配置文件进行配置

* 创建三个配置文件(不要乱放，spring默认是config文件夹)
* 在application.properties 中调用就行
* spring.profiles.active=prod
##### 生命周期


### AOP


### SpringMVC
http默认访问80，https访问443
##### 注解使用
* `Controller`+`@ResponseBody` = `@RestController`
* `@RequestMapping("/")`标注路径
* `GetMapping("")` `@PostMapping("")`
##### swagger的使用
* 访问knife4j
* 导入依赖
* 添加配置文件,
* 访问/doc.html